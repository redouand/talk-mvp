{"version":3,"sources":["media/join.mp3","media/leave.mp3","App.js","socket.io/updateRooms.js","index.js"],"names":["socket","SOCKETIO","App","useState","Audio","joinFile","joinSound","leaveFile","leaveSound","name","setName","rooms","setRooms","joined","roomId","joinedStatus","setJoinedStatus","stream","useRef","useEffect","on","ROOMS","scheme","push","userId","pop","restUsers","newRoom","updateRoomEvent","otherUsers","console","log","handleJoinRoom","e","a","target","parentNode","getAttribute","play","navigator","mediaDevices","getUserMedia","audio","streamVar","current","emit","prevRoom","currentRoom","id","handleLeaveRoom","getTracks","stop","onSubmit","preventDefault","children","value","placeholder","onClick","v1","disabled","Object","keys","map","i","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.e5932634.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/join.f2723e70.mp3\";","export default __webpack_public_path__ + \"static/media/leave.e069f015.mp3\";","import React, { useEffect, useRef, useState } from \"react\";\nimport { v1 } from \"uuid\";\nimport SOCKETIO from \"socket.io-client\";\n\nimport { updateRoomEvent } from './socket.io/updateRooms'\nimport joinFile from './media/join.mp3'\nimport leaveFile from './media/leave.mp3'\nconst socket = SOCKETIO(\"http://localhost:8080\");\n\nconst App = () => {\n  const [joinSound] = useState(new Audio(joinFile));\n  const [leaveSound] = useState(new Audio(leaveFile));\n  const [name, setName] = useState(null);\n  const [rooms, setRooms] = useState({});\n  const [joinedStatus, setJoinedStatus] = useState({ joined: false, roomId: null });\n\n  //-------REFERENCES\n  const stream = useRef({})\n\n  useEffect(() => {\n    socket.on(\"loadRooms\", (ROOMS) => setRooms(ROOMS));\n    socket.on(\"updateRoom\", updateRoomEvent(setRooms));\n    socket.on('otherUsers', (otherUsers)=>console.log(otherUsers))\n  }, []);\n\n\n  const handleJoinRoom = async (e) => {\n    const roomId = e.target.parentNode.getAttribute(\"data-roomid\");\n    joinSound.play()\n    const streamVar = await navigator.mediaDevices.getUserMedia({ audio: true })\n    stream.current = streamVar\n    if (joinedStatus.joined) {\n      socket.emit(\"jumpRoom\", {\n        prevRoom: joinedStatus.roomId,\n        currentRoom: roomId,\n        userId: socket.id,\n        name: name,\n      });\n      setJoinedStatus({ joined: true, roomId: roomId });\n    } else {\n      socket.emit(\"joinRoom\", { roomId, userId: socket.id, name });\n      setJoinedStatus({ joined: true, roomId: roomId });\n    }\n  };\n\n  const handleCreateRoom = () =>\n    socket.emit(\"createRoom\", { roomId: v1(), userId: socket.id });\n\n  const handleLeaveRoom = (e) => {\n    const roomId = e.target.parentNode.getAttribute(\"data-roomid\");\n    leaveSound.play()\n    stream.current.getTracks()[0].stop()\n    socket.emit(\"leaveRoom\", { roomId, userId: socket.id });\n    setJoinedStatus({ joined: false, roomId: null });\n  };\n\n  const handleName = (e) => {\n    e.preventDefault();\n    setName(e.target.children[0].value);\n    e.target.children[0].value = \"\";\n  };\n\n  return (\n    <div>\n      <form onSubmit={handleName}>\n        <input placeholder=\"must enter name first\" />\n      </form>\n\n      {name}\n\n      <button onClick={handleCreateRoom} disabled={name == null}>CREATE ROOM</button>\n      {Object.keys(rooms).map((roomId, i) => (\n        <div data-roomid={roomId} key={i}>\n          <ul>\n            {Object.keys(rooms[roomId]).map((userId, i) => (\n              <li key={i}>\n                {rooms[roomId][userId].name}\n              </li>\n            ))}\n          </ul>\n          {joinedStatus.joined && joinedStatus.roomId === roomId ? (\n            <button onClick={handleLeaveRoom}>Leave</button>\n          ) : (\n            <button onClick={handleJoinRoom} disabled={name == null}>Join</button>\n          )}\n        </div>\n      ))}\n    </div>\n  );\n};\n\nexport default App;\n","export const updateRoomEvent = (setRooms)=>(scheme) => {\n  if (scheme.push) {\n    const { roomId, userId, name } = scheme.push;\n    setRooms((rooms) => {\n      return { ...rooms, [roomId]: { ...rooms[roomId], [userId]: { name } } };\n    });\n  }\n  if (scheme.pop) {\n    const { roomId, userId } = scheme.pop;\n    setRooms((rooms) => {\n      const { [userId]: omit, ...restUsers } = rooms[roomId];\n      return { ...rooms, [roomId]: restUsers };\n    });\n  }\n  if (scheme.newRoom) {\n    const { roomId } = scheme.newRoom;\n    setRooms((rooms) => {\n      return { ...rooms, [roomId]: {} };\n    });\n  }\n};","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}