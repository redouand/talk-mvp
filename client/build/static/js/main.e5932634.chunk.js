(this.webpackJsonpbrush=this.webpackJsonpbrush||[]).push([[0],{77:function(e,t,n){"use strict";n.r(t);var o=n(1),r=n.n(o),a=n(35),c=n.n(a),i=n(19),u=n.n(i),d=n(36),s=n(10),j=n(79),b=n(37),m=n.n(b),l=n(39),O=n(38),p=n(8),f=n(7),h=n.p+"static/media/join.f2723e70.mp3",v=n.p+"static/media/leave.e069f015.mp3",I=n(0),x=m()("http://localhost:8080"),R=function(){var e=Object(o.useState)(new Audio(h)),t=Object(s.a)(e,1)[0],n=Object(o.useState)(new Audio(v)),r=Object(s.a)(n,1)[0],a=Object(o.useState)(null),c=Object(s.a)(a,2),i=c[0],b=c[1],m=Object(o.useState)({}),R=Object(s.a)(m,2),g=R[0],k=R[1],w=Object(o.useState)({joined:!1,roomId:null}),S=Object(s.a)(w,2),y=S[0],A=S[1],C=Object(o.useRef)({});Object(o.useEffect)((function(){x.on("loadRooms",(function(e){return k(e)})),x.on("updateRoom",function(e){return function(t){if(t.push){var n=t.push,o=n.roomId,r=n.userId,a=n.name;e((function(e){return Object(f.a)(Object(f.a)({},e),{},Object(p.a)({},o,Object(f.a)(Object(f.a)({},e[o]),{},Object(p.a)({},r,{name:a}))))}))}if(t.pop){var c=t.pop,i=c.roomId,u=c.userId;e((function(e){var t=e[i],n=(t[u],Object(l.a)(t,[u].map(O.a)));return Object(f.a)(Object(f.a)({},e),{},Object(p.a)({},i,n))}))}if(t.newRoom){var d=t.newRoom.roomId;e((function(e){return Object(f.a)(Object(f.a)({},e),{},Object(p.a)({},d,{}))}))}}}(k)),x.on("otherUsers",(function(e){return console.log(e)}))}),[]);var E=function(){var e=Object(d.a)(u.a.mark((function e(n){var o,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.target.parentNode.getAttribute("data-roomid"),t.play(),e.next=4,navigator.mediaDevices.getUserMedia({audio:!0});case 4:r=e.sent,C.current=r,y.joined?(x.emit("jumpRoom",{prevRoom:y.roomId,currentRoom:o,userId:x.id,name:i}),A({joined:!0,roomId:o})):(x.emit("joinRoom",{roomId:o,userId:x.id,name:i}),A({joined:!0,roomId:o}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(e){var t=e.target.parentNode.getAttribute("data-roomid");r.play(),C.current.getTracks()[0].stop(),x.emit("leaveRoom",{roomId:t,userId:x.id}),A({joined:!1,roomId:null})};return Object(I.jsxs)("div",{children:[Object(I.jsx)("form",{onSubmit:function(e){e.preventDefault(),b(e.target.children[0].value),e.target.children[0].value=""},children:Object(I.jsx)("input",{placeholder:"must enter name first"})}),i,Object(I.jsx)("button",{onClick:function(){return x.emit("createRoom",{roomId:Object(j.a)(),userId:x.id})},disabled:null==i,children:"CREATE ROOM"}),Object.keys(g).map((function(e,t){return Object(I.jsxs)("div",{"data-roomid":e,children:[Object(I.jsx)("ul",{children:Object.keys(g[e]).map((function(t,n){return Object(I.jsx)("li",{children:g[e][t].name},n)}))}),y.joined&&y.roomId===e?Object(I.jsx)("button",{onClick:J,children:"Leave"}):Object(I.jsx)("button",{onClick:E,disabled:null==i,children:"Join"})]},t)}))]})};c.a.render(Object(I.jsx)(r.a.StrictMode,{children:Object(I.jsx)(R,{})}),document.getElementById("root"))}},[[77,1,2]]]);
//# sourceMappingURL=main.e5932634.chunk.js.map